<!DOCTYPE html>
<html lang="en">


<head th:replace="fragments/head :: headFragment"></head>

<head>
    <link rel="stylesheet" href="css/customerPayment.css">

</head>

<body>
    <div class="sidebar">
        <div th:replace="fragments/sidebar :: sidebarFragment"></div>
    </div>
    <div class="main-content">
        <div th:replace="fragments/topbar :: topbarFragment"></div>
        <div class="container-fluid">

            <!-- header -->
            <div class="row align-items-center justify-content-between mb-2">
                <div class="col-auto">
                </div>
            </div>
            <!-- header -->

            <!-- serarch area -->
            <div class="main-card mb-3">
                <div class="row">
                    <div class="col-5"></div>
                    <div class="col-6">
                        <div class="row">
                            <div class="col-4">
                                <label for="" class="form-label">Name</label>
                                <input type="text" name="" id="" placeholder="Search Name" class="form-control">
                            </div>
                            <div class="col-4">
                                <label for="" class="form-label">Vehicle Type</label>
                                <select name="" id="" class="form-select">
                                    <option value="">Select Vehicle Type</option>
                                </select>
                            </div>
                            <div class="col-4 text-end">
                                <label for="" class="form-label">Status</label>
                                <select name="" class="form-select">
                                    <option value="">Select Status</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-1 mt-4 text-end">
                        <button class="btn btn-search mt-3 ms-0"><i class="fas fa-search"></i></button>
                        <button class="btn btn-reset mt-3 ms-0"><i class="fa-solid fa-trash"></i></button>
                    </div>
                </div>
            </div>
            <!-- search area end -->

            <!-- Main Table Card -->
            <div class="main-card">
                <!-- Table Area -->
                <div class="table-responsive">
                    <table class="table table-hover " id="paymentTable">
                        <thead>
                        <tr class="table">
                            <th>#</th>
                            <th>Invoice No</th>
                            <th>Due Amount</th>
                            <th>Total Amount</th>
                            <th>Paid Amount</th>
                            <th>Balance Amount</th>
                            <th>Invoice Date</th>
                        </tr>
                        </thead>
                        <tbody id="paymentTableBody">

                        </tbody>
                    </table>
                </div>
                <!-- Table Area End -->
            </div>

        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="paymentModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" >
            <div class="modal-content" id="paymentModalContent">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Payment Form</h1>
                    <button type="button" class="btn-close ms-1" data-bs-dismiss="modal" aria-label="Close"
                        onclick="refreshCustomerPaymentForm()"></button>
                </div>
                <div class="modal-body">

                    <form id="customerPaymentForm" onsubmit="return false">
                        <div class="p-4">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="textInvoiceNo" class="form-label">Invoice No</label>
                                    <input type="text" name="" id="textInvoiceNo" class="form-control" readonly>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="textInvoiceDate" class="form-label">Invoice Date</label>
                                    <input type="date" name="" id="textInvoiceDate" class="form-control" readonly>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="textTotalAmount" class="form-label">Total Amount</label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">RS.</span>
                                        <input type="text" readonly id="textTotalAmount" class="form-control" placeholder="Total Amount">
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="textDueAmount" class="form-label">Due Amount </label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">RS.</span>
                                        <input type="text" readonly id="textDueAmount" class="form-control" placeholder="Due Amount">
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="textCurrentAmount" class="form-label">Paid Amount </label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">RS.</span>
                                        <input type="text" readonly id="textCurrentAmount" class="form-control" placeholder="Paid Amount"

                                        >
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="selectPaymentMethod" class="form-label">Payment Method</label>
                                    <select name="" id="selectPaymentMethod" class="form-select" required onchange="paymentMethodSelect(this),innerFormTableBodyClear(),selectElementValidator(this,'customerPayment','method')">
                                        <option value="" selected disabled>Select Payment Method
                                        <option value="Cash">Cash</option>
                                        <option value="Cheque">Cheque</option>
                                        <option value="Inter Bank Transfer(IBT)">Inter Bank Transfer(IBT)</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3" >
                                    <label for="textBalanceAmount" class="form-label">Balance Amount </label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">RS.</span>
                                        <input type="text" id="textBalanceAmount" class="form-control" placeholder="Balance Amount"
                                               oninput="convertNoWithTwoDecimals(this)"
                                               onblur="convertToCurrencyFormat(this)"
                                               onfocus="assignValueToWithOutCurrencyFormat(this)"
                                               readonly>
                                    </div>
                                </div>
                                <!--cash select karanwa nam-->
                                <div class="col-md-12 mb-3" id="methodOfCash" style="display:none;">
                                    <label for="textCurrentTypeAmount" class="form-label">Cash Amount </label>
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">RS.</span>
                                        <input type="text" id="textCurrentTypeAmount" class="form-control" placeholder="Enter Amount"
                                               oninput="convertNoWithTwoDecimals(this)"
                                               onblur="convertToCurrencyFormat(this)"
                                               onkeyup="paymentMethodCash(this)">
                                    </div>
                                </div>
                                <!-- cash select eka iawara wena thana -->

                                <!--Cheque select Karanawa nam-->
                                <!--innerForm ekakui tabale ekaui dispaly wenna oni-->

                                <div class="col-md-12 mb-3" id="methodOfCheque">
                                    <!--inner form start-->
                                    <div class="row">
                                        <div class="col-4">
                                            <label for="textChequeNo" class="form-label">Cheque No</label>
                                            <input type="text" name="" id="textChequeNo" class="form-control"
                                                placeholder="Ex:- 4512-8457-5481-8745" oninput="formatInput(this)" onkeyup="validator(this,'^[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{4}$','chequePayment','cheque_no'),checkExtChequeNo()">
                                        </div>

                                        <div class="col-3">
                                            <label for="textChequeAmount" class="form-label">Amount </label>
                                            <div class="input-group mb-3">
                                                <span class="input-group-text">RS.</span>
                                                <input type="text"  id="textChequeAmount" class="form-control" placeholder="Enter Amount"
                                                       oninput="convertNoWithTwoDecimals(this)"
                                                       onblur="convertToCurrencyFormat(this)"
                                                       onfocus="assignValueToWithOutCurrencyFormat(this)"
                                                       onkeyup="validator(this,'^(([1-9][0-9]{0,9})|([1-9][0-9]{0,9}[.][0-9]{2}))$','chequePayment','cheque_amount')">
                                            </div>
                                        </div>
                                        <div class="col-3">
                                            <label for="textChequeDate" class="form-label">Cheque Date</label>
                                            <input type="date" name="" id="textChequeDate" class="form-control" onchange="dateElementValidator(this,'chequePayment','cheque_date')">
                                        </div>
                                        <div class="col-2 mt-4">
                                            <button type="button" class="btn-3d btn-3d-update mt-1"
                                                id="updateButtonChequeInnerForm" style="display: none" onclick="chequeInnerFormUpdate()">
                                                <i class="fa-solid fa-arrows-rotate me-3"></i>
                                                Update
                                            </button>

                                            <button type="button" id="submitButtonChequeInnerForm"
                                                class="btn-3d btn-3d-submit mt-1" onclick="chequeInnerFormSubmit()">
                                                <i class="fa-solid fa-check me-3"></i>
                                                Add
                                            </button>
                                        </div>
                                    </div>
                                    <!--inner form end-->
                                    <!--inner table start-->
                                    <div class="row">
                                        <div class="col-md-12 table-card p-3">
                                            <div class="table-responsive">
                                                <table class="table table-bordered" id="innerChequeTable">
                                                    <thead>
                                                        <tr>
                                                            <th>#</th>
                                                            <th>Cheque No</th>
                                                            <th>Cheque Date</th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="innerChequeTableBody">
                                                        <!-- Dynamic rows will be added here -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <!--inner table end-->
                                </div>
                                <!--Cheque select kalama view wena div eka end-->

                                <!-- Ibt select kaloth meka view wenawa -->
                                <div class="col-md-12 mb-3" id="methodOfIbt">
                                    <!--inner form start-->
                                    <div class="row">
                                        <div class="col-4">
                                            <label for="textReferenceNo" class="form-label">Reference No</label>
                                            <input type="text" name="" id="textReferenceNo" class="form-control"
                                                   placeholder="Enter Reference No" onkeyup="validator(this,'^[A-Za-z0-9]{14,16}$','ibtPayment','reference_no'),checkExtReferenceNo()">
                                        </div>

                                        <div class="col-3">
                                            <label for="textIbtAmount" class="form-label">Amount </label>
                                            <div class="input-group mb-3">
                                                <span class="input-group-text">RS.</span>
                                                <input type="text"  id="textIbtAmount" class="form-control" placeholder="Enter Amount"
                                                       oninput="convertNoWithTwoDecimals(this)"
                                                       onblur="convertToCurrencyFormat(this)"
                                                       onfocus="assignValueToWithOutCurrencyFormat(this)"
                                                       onkeyup="validator(this,'^(([1-9][0-9]{0,9})|([1-9][0-9]{0,9}[.][0-9]{2}))$','ibtPayment','amount')">
                                            </div>
                                        </div>

                                        <div class="col-3">
                                            <label for="textIbtDate" class="form-label">Date</label>
                                            <input type="date" name="" id="textIbtDate" class="form-control" onchange="dateElementValidator(this,'ibtPayment','ibt_date')">
                                        </div>
                                        <div class="col-2 mt-4">
                                            <button type="button" class="btn-3d btn-3d-update mt-1"
                                                    id="updateButtonIbtInnerForm" style="display: none" onclick="ibtInnerFormUpdate()">
                                                <i class="fa-solid fa-arrows-rotate me-3"></i>
                                                Update
                                            </button>

                                            <button type="button" id="submitButtonIbtInnerForm"
                                                    class="btn-3d btn-3d-submit mt-1" onclick="ibtInnerFormSubmit()">
                                                <i class="fa-solid fa-check me-3"></i>
                                                Add
                                            </button>
                                        </div>
                                    </div>
                                    <!--inner form end-->
                                    <!--inner table start-->
                                    <div class="row">
                                        <div class="col-md-12 table-card p-3">
                                            <div class="table-responsive ">
                                                <table class="table table-bordered" id="innerIbtTable">
                                                    <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        <th>Reference No</th>
                                                        <th>Date</th>
                                                        <th>Amount</th>
                                                        <th>Action</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="innerIbtTableBody">
                                                    <!-- Dynamic rows will be added here -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <!--inner table end-->
                                </div>
                                <!-- Ibt select kalama view wena div eka end -->


                                <!-- buttons -->
                                <div class="mb-4">
                                    <div class="row mt-3">
                                        <div class="col-6">
                                        </div>
                                        <div class="col-6">
                                            <div class="row">
                                                <div class="col-4"></div>
                                                <div class="col-4 text-start">
                                                    <button type="button" id="deleteButtonFrom"
                                                        class="btn-3d btn-3d-cancel" onclick="refreshCustomerPaymentForm()">
                                                        <i class="fa-solid fa-xmark me-3"></i>
                                                        Cancel</button>
                                                </div>
                                                <div class="col-4 text-start">
                                                    <button type="submit" id="submitButton" class="btn-3d btn-3d-submit"
                                                        onclick="customerPaymentPaidButton()">
                                                        <i class="fa-solid fa-check me-3"></i>
                                                        Submit</button>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <!-- buttons -->
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div th:replace="fragments/loading :: overlayFragment"></div>

    <script src="/commenjs/reusabal.js"></script>
    <script src="/commenjs/commanValidation.js"></script>
    <script src="/commenjs/commonTable.js"></script>
    <script src="js/customerPayment.js"></script>
    <script src="js/sidebar.js"></script>
</body>

</html>